-- FIND GIVEN NUMBER IS EVEN OR ODD

SET N=1232;

EXECUTE IMMEDIATE
$$
BEGIN
    IF ($N % 2 = 0) THEN
        RETURN 'Given Number is EVEN';
    ELSE 
        RETURN 'Given Number is ODD';
    END IF;
END;
$$;


-- FIND TAX AMMOUNT FOR GIVEN MONTHLY SALARY AMOUNT

SET MONTHLY_SAL = 39000;

EXECUTE IMMEDIATE

$$
DECLARE
    TAX FLOAT;
    TAX10 FLOAT; TAX20 FLOAT; TAX30 FLOAT;
BEGIN
    IF ($MONTHLY_SAL * 12 <= 500000) THEN
        TAX := 0;
    ELSEIF (($MONTHLY_SAL * 12) BETWEEN 500001 AND 1000000) THEN
        TAX := (($MONTHLY_SAL * 12) - 500000) * 10/100;
    ELSEIF (($MONTHLY_SAL * 12) BETWEEN 1000001 AND 1500000) THEN
        TAX10 := (1000000 - 500000) * 10/100;
        TAX20 := (($MONTHLY_SAL * 12) - 1000000) * 20/100;
        TAX := TAX10 + TAX20;

    ELSE 
        TAX10 := (1000000 - 500000) * 10/100;
        TAX20 := (1500000 - 1000000) * 20/100;
        TAX30 := (($MONTHLY_SAL * 12) - 1500000) * 30/100;
        TAX := TAX10 + TAX20 + TAX30;
    END IF;

    RETURN 'Calculated TAX is: ' || TAX;
END;
$$;

-- FIND TAX AMMOUNT FOR GIVEN MONTHLY SALARY AMOUNT USING CASE 

CREATE OR REPLACE PROCEDURE EMP.PROCS.SP_CASE_DEMO("MON_GROS_SAL" FLOAT)
RETURNS FLOAT
LANGUAGE SQL
EXECUTE AS CALLER
AS
DECLARE
    TAX FLOAT;
BEGIN 
    TAX := CASE WHEN (MON_GROS_SAL * 12 <= 500000) THEN 0
            WHEN ((MON_GROS_SAL * 12) BETWEEN 500001 AND 1000000)
                THEN ((MON_GROS_SAL * 12) - 500000) * 10/100
            WHEN ((MON_GROS_SAL * 12) BETWEEN 1000001 AND 1500000)
                THEN ((1000000 - 500000) * 10/100) + (((MON_GROS_SAL * 12) - 1000000) * 20/100)
            ELSE                
                ((1000000 - 500000) * 10/100) + ((1500000 - 1000000) * 20/100) + (((MON_GROS_SAL * 12) - 1500000) * 30/100)
            END;

RETURN 'Calculated Annual TAX is: ' || TAX;
END;

CALL EMP.PROCS.SP_CASE_DEMO(70000);




                