CREATE OR REPLACE PROCEDURE DEV_EMP.PROCS.SP_TO_DROP_SCHEMA_VIEWS("DB" VARCHAR,"SCHEMA" VARCHAR)
RETURNS VARCHAR
LANGUAGE SQL
EXECUTE AS CALLER
AS
DECLARE

    CUR_TBL_LIST CURSOR FOR SELECT DISTINCT TABLE_NAME FROM TABLE(?) WHERE TABLE_SCHEMA = ? AND TABLE_TYPE = 'VIEW';
    RET_STRING VARCHAR;
    TBL_NM VARCHAR;
    FQ_TBL_NM VARCHAR;
    DROP_QUERY VARCHAR;

BEGIN

    IF(UPPER(:DB) LIKE '%PROD' OR UPPER(:DB) LIKE '%PRD') THEN
        RET_STRING := 'Warning!! you are running this procedure in Production DataBase';

    ELSE
        OPEN CUR_TBL_LIST USING (:DB||'.INFORMATION_SCHEMA.TABLES', :SCHEMA);

        FOR TBL IN CUR_TBL_LIST DO
            TBL_NM := TBL.TABLE_NAME;
            FQ_TBL_NM := :DB||'.'||:SCHEMA||'."'||:TBL_NM||'"';
            DROP_QUERY := 'DROP VIEW ' || :FQ_TBL_NM;
            EXECUTE IMMEDIATE :DROP_QUERY;

        END FOR;

        CLOSE CUR_TBL_LIST;

        RET_STRING := 'All the VIEWS have been Dropped Successfully';

    END IF;
    RETURN RET_STRING;
END;

CALL DEV_EMP.PROCS.SP_TO_DROP_SCHEMA_VIEWS('DEV_EMP','HRDATA');
    